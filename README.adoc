= rhel-centos-ec2-vuls

Install and execute the Vuls vulnerability scanner (https://vuls.io) for RHEL/CentOS on AWS EC2


== Description

Vuls is an open-source, agent-less vulnerability scanner based on information from NVD, OVAL, etc.

Use these two scripts to install Vuls and run vulnerability scans on your RHEL/CentOS instance on AWS EC2.


=== Installation

```sh
sudo ./install-vuls.sh
```

==== Example installation on RHEL 7.5

```console
$ sudo ./install-vuls.sh
install-vuls.sh: creating '/etc/profile.d/vuls-env.sh'
install-vuls.sh: sourcing '/etc/profile.d/vuls-env.sh'
install-vuls.sh: go get 'github.com/kotakanbe/go-cve-dictionary'
install-vuls.sh: go-cve-dictionary fetchnvd -years '2004'
install-vuls.sh: go-cve-dictionary fetchnvd -years '2005'
install-vuls.sh: go-cve-dictionary fetchnvd -years '2006'
install-vuls.sh: go-cve-dictionary fetchnvd -years '2007'
install-vuls.sh: go-cve-dictionary fetchnvd -years '2008'
install-vuls.sh: go-cve-dictionary fetchnvd -years '2009'
install-vuls.sh: go-cve-dictionary fetchnvd -years '2010'
install-vuls.sh: go-cve-dictionary fetchnvd -years '2011'
install-vuls.sh: go-cve-dictionary fetchnvd -years '2012'
install-vuls.sh: go-cve-dictionary fetchnvd -years '2013'
install-vuls.sh: go-cve-dictionary fetchnvd -years '2014'
install-vuls.sh: go-cve-dictionary fetchnvd -years '2015'
install-vuls.sh: go-cve-dictionary fetchnvd -years '2016'
install-vuls.sh: go-cve-dictionary fetchnvd -years '2017'
install-vuls.sh: go-cve-dictionary fetchnvd -years '2018'
install-vuls.sh: git clone 'goval-dictionary'
Cloning into 'goval-dictionary'...
go get -u github.com/golang/dep/...
dep ensure
go install -ldflags "-X 'main.version=' -X 'main.revision=652b729'"
install-vuls.sh: goval-dictionary fetch-redhat 7
install-vuls.sh: git clone 'https://github.com/future-architect/vuls'
Cloning into 'vuls'...
github.com/golang/lint (download)
Fetching https://golang.org/x/lint?go-get=1
Parsing meta tags from https://golang.org/x/lint?go-get=1 (status code 200)
get "golang.org/x/lint": found meta tag get.metaImport{Prefix:"golang.org/x/lint", VCS:"git", RepoRoot:"https://go.googlesource.com/lint"} at https://golang.org/x/lint?go-get=1
golang.org/x/lint (download)
Fetching https://golang.org/x/tools/go/ast/astutil?go-get=1
Parsing meta tags from https://golang.org/x/tools/go/ast/astutil?go-get=1 (status code 200)
get "golang.org/x/tools/go/ast/astutil": found meta tag get.metaImport{Prefix:"golang.org/x/tools", VCS:"git", RepoRoot:"https://go.googlesource.com/tools"} at https://golang.org/x/tools/go/ast/astutil?go-get=1
get "golang.org/x/tools/go/ast/astutil": verifying non-authoritative meta tag
Fetching https://golang.org/x/tools?go-get=1
Parsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)
golang.org/x/tools (download)
Fetching https://golang.org/x/tools/go/gcexportdata?go-get=1
Parsing meta tags from https://golang.org/x/tools/go/gcexportdata?go-get=1 (status code 200)
get "golang.org/x/tools/go/gcexportdata": found meta tag get.metaImport{Prefix:"golang.org/x/tools", VCS:"git", RepoRoot:"https://go.googlesource.com/tools"} at https://golang.org/x/tools/go/gcexportdata?go-get=1
get "golang.org/x/tools/go/gcexportdata": verifying non-authoritative meta tag

install-vuls.sh: Vuls installed
```


=== Usage

```sh
sudo ./scan-vuls.sh
```

==== Example run on RHEL 7.5

```console
$ sudo ./scan-vuls.sh 
scan-vuls.sh: sourcing '/etc/profile.d/vuls-env.sh'
scan-vuls.sh: creating '//usr/local/etc/vuls-config.toml'
scan-vuls.sh: config file:
[servers]
[servers.localhost]
host = "localhost"
port = "local"
scan-vuls.sh: running 'vuls configtest'
[Jul 24 09:27:18]  INFO [localhost] Validating config...
[Jul 24 09:27:18]  INFO [localhost] Detecting Server/Container OS... 
[Jul 24 09:27:18]  INFO [localhost] Detecting OS of servers... 
[Jul 24 09:27:18]  INFO [localhost] (1/1) Detected: localhost: redhat 7.5
[Jul 24 09:27:18]  INFO [localhost] Detecting OS of containers... 
[Jul 24 09:27:18]  INFO [localhost] Checking dependencies...
[Jul 24 09:27:18]  INFO [localhost] Dependencies ... Pass
[Jul 24 09:27:18]  INFO [localhost] Checking sudo settings...
[Jul 24 09:27:18]  INFO [localhost] sudo ... No need
[Jul 24 09:27:18]  INFO [localhost] Scannable servers are below...
localhost 
scan-vuls.sh: running 'vuls scan'
[Jul 24 09:27:18]  INFO [localhost] Start scanning
[Jul 24 09:27:18]  INFO [localhost] config: //usr/local/etc/vuls-config.toml
[Jul 24 09:27:18]  INFO [localhost] Validating config...
[Jul 24 09:27:18]  INFO [localhost] Detecting Server/Container OS... 
[Jul 24 09:27:18]  INFO [localhost] Detecting OS of servers... 
[Jul 24 09:27:18]  INFO [localhost] (1/1) Detected: localhost: redhat 7.5
[Jul 24 09:27:18]  INFO [localhost] Detecting OS of containers... 
[Jul 24 09:27:18]  INFO [localhost] Detecting Platforms... 
[Jul 24 09:27:18]  INFO [localhost] (1/1) localhost is running on aws
[Jul 24 09:27:18]  INFO [localhost] Scanning vulnerabilities... 
[Jul 24 09:27:18]  INFO [localhost] Scanning vulnerable OS packages...
scan-vuls.sh: running 'vuls report'
[Jul 24 09:27:23]  INFO [localhost] Validating config...
[Jul 24 09:27:23]  INFO [localhost] cve-dictionary: /usr/local/vuls/cve.sqlite3
[Jul 24 09:27:23]  INFO [localhost] oval-dictionary: /usr/local/vuls/oval.sqlite3
[Jul 24 09:27:23]  INFO [localhost] Loaded: /usr/local/vuls/results/2018-07-24T09:27:18Z
[Jul 24 09:27:23]  INFO [localhost] Fill CVE detailed information with OVAL
[Jul 24 09:27:23]  WARN [localhost] OVAL entries of redhat 7.5 are not found. It's recommended to use OVAL to improve scanning accuracy. For details, see https://github.com/kotakanbe/goval-dictionary#usage , Then report with --ovaldb-path or --ovaldb-url flag
[Jul 24 09:27:23]  INFO [localhost] Fill CVE detailed information with CVE-DB
scan-vuls.sh: no vulnerabilities identified
```


== Contributions

Feel free to open an issue or to send a pull request.

